# Kong Declarative Configuration Generated by GAL
_format_version: '3.0'

upstreams:
- name: canary_deployment_api_route0_upstream
  algorithm: round-robin
  targets:
  - target: api-v1-stable:8080
    weight: 900
  - target: api-v1-canary:8080
    weight: 100
- name: ab_testing_api_route0_upstream
  algorithm: round-robin
  targets:
  - target: api-v2-a:8080
    weight: 500
  - target: api-v2-b:8080
    weight: 500
- name: beta_testing_api_route0_upstream
  algorithm: round-robin
  targets:
  - target: api-prod:8080
    weight: 1000
  - target: api-beta:8080
    weight: 0
- name: user_segment_api_route0_upstream
  algorithm: round-robin
  targets:
  - target: api-stable:8080
    weight: 1000
  - target: api-canary:8080
    weight: 0
- name: multi_rule_api_route0_upstream
  algorithm: round-robin
  targets:
  - target: api-stable:8080
    weight: 700
  - target: api-beta:8080
    weight: 200
  - target: api-canary:8080
    weight: 100
- name: gradual_rollout_api_route0_upstream
  algorithm: round-robin
  targets:
  - target: api-v1:8080
    weight: 950
  - target: api-v2:8080
    weight: 50

services:
- name: canary_deployment_api
  protocol: http
  host: canary_deployment_api_route0_upstream
  routes:
  - name: canary_deployment_api_route
    paths:
    - /api/v1
    methods:
    - GET
    - POST
    - PUT
    - DELETE

- name: ab_testing_api
  protocol: http
  host: ab_testing_api_route0_upstream
  routes:
  - name: ab_testing_api_route
    paths:
    - /api/v2
    methods:
    - GET
    - POST

- name: beta_testing_api
  protocol: http
  host: beta_testing_api_route0_upstream
  routes:
  - name: beta_testing_api_route
    paths:
    - /api/beta
    methods:
    - GET
    - POST
    - PUT
    - DELETE

- name: user_segment_api
  protocol: http
  host: user_segment_api_route0_upstream
  routes:
  - name: user_segment_api_route
    paths:
    - /api/users
    methods:
    - GET
    - POST
    - PUT
    - DELETE

- name: multi_rule_api
  protocol: http
  host: multi_rule_api_route0_upstream
  routes:
  - name: multi_rule_api_route
    paths:
    - /api/multi
    methods:
    - GET
    - POST

- name: gradual_rollout_api
  protocol: http
  host: gradual_rollout_api_route0_upstream
  routes:
  - name: gradual_rollout_api_route
    paths:
    - /api/rollout
    methods:
    - GET
    - POST
